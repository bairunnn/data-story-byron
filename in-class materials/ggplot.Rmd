---
title: "GGPlotPractice"
author: "Elizabeth Delmelle"
date: "2023-09-26"
output: html_document
editor_options: 
  markdown: 
    wrap: sentence
---

Today's exercise is brought to you by Kieran Healy's Data Visualization: A practical introduction book.
Thank you Kieran Healy!!

Let's get some freely available data to start working.
We'll use the gapminder package

```{r}
library(tidyverse)
library(gapminder)
gapminder
```

Basic building blocks of ggplot

Long format - every variable is a column.
In a wide format, some variables are spread out across columns (you don't necessarily have a unique identifier).

Let's begin by building the graph of Live Expectancy vs. per capita GDP for all country-years in the data.

```{r}
p <- ggplot(data = gapminder)
```

We need to specify what is being mapped.
Which variables in the data should be represented by which visual elements in the plot.
Also, what kind of plots do we want?
These are specified using the aes() function.

We've given the ggplot() function two arguments: data and mapping.
The data argyement tells ggplot where to find the variables it is about to use.
The mapping argument is a function containing a sequence of definitions that ggplot will use later.
"On the x-axis will be gdpPercap and on the y axis is lifeExp"

why is it blank??
Should we panic?

No, certainly not.
We have no information on what kind of plot to draw.

We need to add a *layer* to the plot.
Pick a geom\_ function.
Let's start with geom_point() which knows how to take x and y values and plot them in a scatterplot.

```{r}
p <- ggplot(data = gapminder,
            mapping = aes(x = gdpPercap,
                          y = lifeExp))
p
```

So far, we have told it what data to map.
The mapping aes() tells us which variables in the data will be represented by visual elements like a color, a shape, or a point.
Now we have to tell it what kind of plot to draw.
We need to add a layer to the plot and pick a 'geom\_' function.

```{r}
p+ geom_point()
p
```

```{r}
p + geom_point() + geom_smooth()
```

```{r}
p + geom_point()+
  geom_smooth(method = "gam")+
  scale_x_log10()
```

Here we will work with the scales library that contains pre-made formatting functions.
Here is an example with the dollar() function.
When we used the scale function, the x-axis got automatically converted to scientific notation.

```{r}
p + geom_point() + 
  geom_smooth(method = "gam")+
  scale_x_log10(labels = scales::comma)
```

# Mapping aestheics versus setting them

An aesthetic mapping specifies that a variable will be expressed by one of the available visual elements like size, color, shape etc.

This code does not give a direct instruction like “color the points purple”.
Instead it says, “the property ‘color’ will represent the variable continent”, or “color will map continent”.
If we want to turn all the points in the figure purple, we do not do it through the mapping function.
Look at what happens when we try:

To change the properties or characteristics of how the data are displayed on the graph, you do that in the geom properties

```{r}
p <-  ggplot(data = gapminder,
             mapping = aes(x = gdpPercap,
                            y = lifeExp,
                            color = continent))
p
```

The aes() function is where the mapping is specified.
It wants to map a variable to the color aesthetic so it assumes you are giving it a variable.
It basically creates a variable called purple and gives every observation the same value...and displays them with the default color - red.
salmon?

the aes() is for mappings only.
Don't use it to change properties to a particular value.
If you want to set a property, do it in geom\_

```{r}
p <- ggplot(data = gapminder,
            mapping = aes(x = gdpPercap,
                          y = lifeExp,
                          color = "purple"))
p + geom_point() +
    geom_smooth(method = "loess") +
    scale_x_log10()
```

Here, geom_point() can take a color argument directly.

```{r}
p <- ggplot(data = gapminder,
            mapping = aes(x = gdpPercap,
                          y = lifeExp))
p + geom_point(color = "purple") +
    geom_smooth(method = "loess") +
    scale_x_log10()
```

```{r}
# Basic ggplot mapping continent to color
ggplot(gapminder, aes(x = gdpPercap, y = lifeExp, color = continent)) +
  geom_point() +
    scale_x_log10() +
  scale_color_manual(values = c("Asia" = "#984ea3", "Europe" = "#4daf4a", 
                                "Africa" = "#e41a1c", "Americas" = "#377eb8", 
                                "Oceania" = "#ff7f00")) +
  theme_light() +
  labs(title = "GDP per Capita vs Life Expectancy",
       x = "GDP per Capita", y = "Life Expectancy",
       color = "Continent")
```

There are many other geom\_ arguments that affect how the plot looks.
Below we fiddle with linewidth, se, method and alpha.
Take a moment to play around with them.

```{r}
p + geom_point(alpha = 0.3) +
    geom_smooth(color = "orange", se = FALSE, linewidth = 1, method = "lm") +
    scale_x_log10() +
  theme_light()
```

Here is a version where we work with the labs function and add labels.

```{r}
p + geom_point(alpha = 0.3) +
  geom_smooth(method = "gam") +
  scale_x_log10(labels = scales::dollar)+
  labs(x = "GDP Per Capita", y = "Life Expectancy in Years",
       title = "Economic Growth and Life Expectancy",
       subtitle = "Data points are country-years",
       caption = "Source: Gapmider")

ggsave(filename = "outputs/plot.png", plot = plot, width = 10, height = 6, dpi = 300)
```

Try something else here.
Mapping Aesthetics per geom

\``{r fig.width = 12, fig.height = 9} p <- ggplot(data = gapminder,             mapping = aes(x = gdpPercap,                           y = lifeExp,                           color = continent)) p + geom_point() +     geom_smooth(method = "loess") +     scale_x_log10() ggsave(filename = "my_figure.png")`
